(window.webpackJsonp=window.webpackJsonp||[]).push([["financial-times-o-expander"],{e3106607:function(e,t,s){"use strict";s.r(t);var o=s("3c85f3e3");let n=0;var i=class{constructor(e,t){if(!(e instanceof Element))throw new Error("Expected an expander Element.");if("object"!=typeof t)throw new Error(`Expected an \`opts\` object, found type of "${typeof t}".`);this._currentState=null,this.options=Object.assign({},{shrinkTo:"height",toggleState:"all"},t),isNaN(this.options.shrinkTo)||(this.options.shrinkTo=Number(this.options.shrinkTo));const s=["toggle","content"];"number"==typeof this.options.shrinkTo&&s.push("item");const i=Object.keys(t.selectors),a=s.filter(e=>-1===i.indexOf(e));if("object"!=typeof t.selectors||a.length)throw new Error(`Expected the following "selectors" to be specified within the options object "${s}", missing "${a}".`);const r=["initialized","inactive","expanded","collapsed"];"number"==typeof this.options.shrinkTo&&r.push("collapsibleItem");const l=Object.keys(t.classnames),c=r.filter(e=>-1===l.indexOf(e));if("object"!=typeof t.selectors||c.length)throw new Error(`Expected the following "classnames" to be specified within the options object "${r}", missing "${c}".`);if(!this.options.expandedToggleText)switch(this.options.shrinkTo){case"hidden":this.options.expandedToggleText="hide";break;case"height":this.options.expandedToggleText="less";break;default:this.options.expandedToggleText="fewer"}if(this.options.collapsedToggleText||(this.options.collapsedToggleText="hidden"===this.options.shrinkTo?"show":"more"),this.oExpanderElement=e,this.contentElement=this.oExpanderElement.querySelector(this.options.selectors.content),this.toggles=[].slice.apply(this.oExpanderElement.querySelectorAll(this.options.selectors.toggle)),!this.toggles.length)throw new Error(`o-expander needs a toggle link or button. None were found for toggle selector "${this.options.selectors.toggle}".`);if(this.id=this.contentElement.id,!this.id){for(;document.querySelector("#o-expander__toggle--"+n);)n++;this.id=this.contentElement.id="o-expander__toggle--"+n}this.toggles.forEach(e=>e.setAttribute("aria-controls",this.id)),this.toggles.forEach(e=>{e.addEventListener("click",()=>this.toggle())}),"height"===this.options.shrinkTo&&(o.default.listenTo("resize"),o.default.listenTo("orientation"),document.body.addEventListener("oViewport.orientation",()=>this.apply()),document.body.addEventListener("oViewport.resize",()=>this.apply())),this.oExpanderElement.classList.add(this.options.classnames.initialized),this.apply(!0),this._dispatchEvent("init")}apply(e){if(this._isActive()){if(this.oExpanderElement.classList.remove(this.options.classnames.inactive),"number"==typeof this.options.shrinkTo){this._getCollapseableItems().forEach(e=>e.classList.add(this.options.classnames.collapsibleItem))}this.isCollapsed()?this.collapse(e):this.expand(e)}else this.oExpanderElement.classList.add(this.options.classnames.inactive)}toggle(){this.isCollapsed()?this.expand():this.collapse()}expand(e){this._setExpandedState("expand",e)}collapse(e){this._setExpandedState("collapse",e)}isCollapsed(){return this._currentState?"collapse"===this._currentState:"hidden"===this.options.shrinkTo?"false"!==this.contentElement.getAttribute("aria-hidden"):!this.contentElement.classList.contains(this.options.classnames.expanded)}destroy(){"height"===this.options.shrinkTo&&(document.body.removeEventListener("oViewport.orientation",()=>this.apply()),document.body.removeEventListener("oViewport.resize",()=>this.apply())),this.toggles.forEach(e=>{e.removeEventListener("click",this.toggle),e.removeAttribute("aria-controls"),e.removeAttribute("aria-expanded")}),this.contentElement.removeAttribute("aria-hidden"),this.contentElement.classList.remove(this.options.classnames.expanded),this.contentElement.classList.remove(this.options.classnames.collapsed),this.oExpanderElement.classList.remove(this.options.classnames.initialized)}_getCollapseableItems(){const e=this._getItems();return Array.from(e).splice(this.options.shrinkTo)}_getItems(){if("number"!=typeof this.options.shrinkTo)throw new Error("Can not get items for an expander which is not based on a number of items.");return this.contentElement.querySelectorAll(this.options.selectors.item)}_isActive(){if("hidden"===this.options.shrinkTo)return!0;if("number"==typeof this.options.shrinkTo){return this._getItems().length>this.options.shrinkTo}let e=!1;return this.isCollapsed()?e=this.contentElement.clientHeight<this.contentElement.scrollHeight:(this.collapse(),e=this.contentElement.clientHeight<this.contentElement.scrollHeight,this.expand()),e}_setExpandedState(e,t){this._currentState=e,this.contentElement.classList.toggle(this.options.classnames.expanded,"expand"===e),this.contentElement.classList.toggle(this.options.classnames.collapsed,"expand"!==e);const s="expand"===e?"false":"true";if("hidden"===this.options.shrinkTo&&this.contentElement.setAttribute("aria-hidden",s),"number"==typeof this.options.shrinkTo){this._getCollapseableItems().forEach(e=>e.setAttribute("aria-hidden",s))}"none"!==this.options.toggleState&&this.toggles.forEach(t=>{"aria"!==this.options.toggleState&&(t.innerHTML="expand"===e?this.options.expandedToggleText:this.options.collapsedToggleText),t.setAttribute("aria-expanded","expand"===e?"true":"false")}),t||this._dispatchEvent(e)}_dispatchEvent(e){this.oExpanderElement.dispatchEvent(new CustomEvent("oExpander."+e,{bubbles:!0}))}};class a extends i{constructor(e,t){const s=t||a._getDataAttributes(e);super(e,Object.assign(s,{selectors:{toggle:".o-expander__toggle",content:".o-expander__content",item:s.itemSelector||"li"},classnames:{initialized:"o-expander--initialized",inactive:"o-expander--inactive",expanded:"o-expander__content--expanded",collapsed:"o-expander__content--collapsed",collapsibleItem:"o-expander__collapsible-item"}}))}static createCustom(e,t){return new i(e,t)}static init(e,t){return e||(e=document.body),e instanceof HTMLElement||(e=document.querySelector(e)),e instanceof HTMLElement&&e.matches("[data-o-component=o-expander]")?new a(e,t):Array.from(e.querySelectorAll('[data-o-component="o-expander"]'),e=>new a(e,t))}static _getDataAttributes(e){return e instanceof HTMLElement?Object.keys(e.dataset).reduce((t,s)=>{if("oComponent"===s)return t;const o=s.replace(/^oExpander(\w)(\w+)$/,(e,t,s)=>t.toLowerCase()+s),n=e.dataset[s];try{t[o]=JSON.parse(n.replace(/\'/g,'"'))}catch(e){t[o]=n}return t},{}):{}}}var r=a;const l=function(){r.init(),document.removeEventListener("o.DOMContentLoaded",l)};"undefined"!=typeof document&&document.addEventListener("o.DOMContentLoaded",l);t.default=r}}]);
//# sourceMappingURL=financial-times-o-expander.7eef33c3001d.bundle.js.map